<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Sản phẩm yêu thích | ITP System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        body { background-color: #f8fafc; font-family: 'Inter', sans-serif; }
        .product-card { border-radius: 12px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1); background: #fff; transition: all 0.2s ease; }
        .product-card:hover { transform: translateY(-4px); box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .product-image { width: 100%; height: 200px; object-fit: cover; }
        .product-body { padding: 1rem; }
        .product-price { font-weight: 700; color: #0ea5e9; }
        .product-footer { font-size: 0.85rem; color: #64748b; margin-top: 0.5rem; }
        .remove-btn {
            position: absolute; top: 10px; right: 10px;
            border: none; background: none;
            color: #ef4444; font-size: 1.3rem;
        }
        .remove-btn:hover { color: #dc2626; }
    </style>
</head>

<body>

<!-- Header -->
<div th:replace="~{/Included/Header :: header}"></div>

<div class="container py-5">

    <nav aria-label="breadcrumb">
        <ol class="breadcrumb mb-4">
            <li class="breadcrumb-item"><a th:href="@{/}">Trang chủ</a></li>
            <li class="breadcrumb-item active">Sản phẩm yêu thích</li>
        </ol>
    </nav>

    <h2 class="fw-bold mb-4 text-center">❤️ Danh sách sản phẩm yêu thích</h2>

    <div class="row g-4" th:if="${favorites != null and !#lists.isEmpty(favorites)}">
        <div class="col-md-3" th:each="fav : ${favorites}">
            <div class="product-card position-relative">

                <!-- Nút bỏ yêu thích -->
                <form th:action="@{'/favorites/remove/' + ${fav.productId}}" method="post">
                    <button type="submit" class="remove-btn" title="Bỏ yêu thích">
                        <i class="fa-solid fa-heart-circle-xmark"></i>
                    </button>
                </form>

                <img class="product-image"
                     th:src="${fav.productImage != null ? fav.productImage : 'https://picsum.photos/seed/placeholder/400/300'}"
                     alt="Ảnh sản phẩm"/>

                <div class="product-body">
                    <h6 class="fw-bold mb-1" th:text="${fav.productName}">Tên sản phẩm</h6>

                    <div class="product-footer">
                        <small th:text="'Đã thêm: ' + ${#temporals.format(fav.createdAt, 'dd/MM/yyyy HH:mm')}"></small>
                    </div>

                    <a th:href="@{'/product/' + ${fav.productId}}"
                       class="btn btn-sm btn-outline-primary mt-2 w-100">
                        Xem chi tiết
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Khi không có yêu thích -->
    <div class="text-center py-5 text-muted"
         th:if="${favorites == null or #lists.isEmpty(favorites)}">
        <h5 class="mb-3">Bạn chưa có sản phẩm nào trong danh sách yêu thích.</h5>
        <a class="btn btn-primary btn-sm" th:href="@{/products}">
            <i class="fa fa-store"></i> Xem tất cả sản phẩm
        </a>
    </div>

</div>

<!-- Footer -->
<div th:replace="~{/Included/Footer :: footer}"></div>

</body>
</html>
